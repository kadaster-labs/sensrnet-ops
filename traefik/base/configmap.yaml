kind: ConfigMap
apiVersion: v1
metadata:
  name: traefik-conf
data:
  traefik.toml: |
    # traefik.toml
    traefikEntryPoints = ["http"]
    InsecureSkipVerify = true
    checkNewVersion = false
    [entryPoints]
      [entryPoints.http]
        address = ":80"
      [entryPoints.api]
        address = ":8080"
        [entryPoints.api.auth]
          [entryPoints.api.auth.basic]
            users = [
              "admin:$apr1$XqddPymP$Qe5Q4Kv0fyyf6dSfihwX/1"
            ]
      [entryPoints.metrics]
        address = ":8081"
      [entryPoints.ping]
        address = ":8082"
    [backends]
      [backends.backend1]
        # Enable sticky session
        [backends.backend1.loadbalancer.stickiness]
    [kubernetes]
    [api]
      entrypoint = "api"
      dashboard = true
    [metrics]
      [metrics.prometheus]
        entryPoint = "metrics"
    [ping]
      entrypoint = "ping"
    [accessLog]
      format = "json"
